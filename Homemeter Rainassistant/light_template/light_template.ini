[Rainmeter]
LeftMouseUpAction= [curl -X POST -H "Authorization: Bearer #HA_auth#" -H "Content-Type: application/json" -d "{\"entity_id\": #entity_id2#}" #HA_addr#/api/services/light/toggle][!CommandMeasure haapi "Update"]
DynamicWindowSize=1

[Metadata]
Author=Shades84
Information=Template to toggle and view light state (no brightness or color control at the moment)

[Variables]
entity_id="switch.ENTITYID"
entity_id2="\"#entity_id#\""
@Include=#@#\options.inc

[MeterString]
Meter=String
Text=YOUR TEXT HERE
ClipString=2
x=50
y=40
w=100
StringAlign=Center
FontColor= #color_text#
FontFace=Roboto Light

[Image]
Meter=Image
ImageName=#@#\icons\#img_name#
x= 26
DynamicVariables=1

[HAapi]
Measure=WebParser
URL=#HA_addr#/api/states/#entity_id#
Header=Content-Type: application/json
Header2=Authorization: Bearer #HA_auth#
RegExp=(?siU)^(.*)$
UpdateRate=#rate#

[HAparse]
Measure=Plugin
Plugin=JsonParser.dll
Source=[HAapi]
Query="state"
IfMatch=on
IfMatchAction=[!SetVariable img_name "lightbulb_highlight.png"]
IfNotMatchAction=[!SetVariable img_name "lightbulb_#color_icon#.png"]
