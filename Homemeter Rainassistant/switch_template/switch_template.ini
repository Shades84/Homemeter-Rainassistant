[Rainmeter]
LeftMouseUpAction= [curl -X POST -H "Authorization: Bearer #HA_auth#" -H "Content-Type: application/json" -d "{\"entity_id\": #entity_id2#}" #HA_addr#/api/services/switch/toggle][!CommandMeasure haapi "Update"]
DynamicWindowSize=1

[Metadata]
Author=Shades84
Information=Switch toggle and state template

[Variables]
entity_id="switch.ENTITYID"
entity_id2="\"#entity_id#\""
@Include=#@#\options.inc

[background]
Meter=Shape
Shape=Rectangle (#icon_size#/2 ),0,(#icon_size#),(#icon_size#+ 35),5,5 | Fill Color #color_bg# | StrokeWidth 0

[Image]
Meter=Image
ImageName=#@#\icons\#img_name#
x= (#icon_size# /2)
h= #icon_size#
w= #icon_size#
DynamicVariables=1

[MeterString]
Meter=String
Text=Switch Toggle
ClipString=2
x= #icon_size#
y= 2R
w=50
StringAlign=Center
FontColor= #color_text#
FontFace=Roboto Light

[HAapi]
Measure=WebParser
URL=#HA_addr#/api/states/#entity_id#
Header=Content-Type: application/json
Header2=Authorization: Bearer #HA_auth#
RegExp=(?siU)^(.*)$
UpdateRate=#rate#

[HAparse]
Measure=Plugin
Plugin=JsonParser.dll
Source=[HAapi]
Query="state"
IfMatch=on
IfMatchAction=[!SetVariable img_name "flash_highlight.png"]
IfNotMatchAction=[!SetVariable img_name "flash_#color_icon#.png"]
